{"version":3,"sources":["../../wechat/util.js"],"names":["xml2js","require","Promise","exports","parseXMLAsync","xml","resolve","reject","parseString","trim","err","content","formatMessage","result","message","keys","Object","i","length","item","key","Array","val","j","k","push"],"mappings":";;;;AAAA,IAAIA,SAASC,QAAQ,QAAR,CAAb;AACA,IAAIC,UAAUD,QAAQ,UAAR,CAAd;;AAEAE,QAAQC,aAAR,GAAwB,UAAUC,GAAV,EAAe;AACrC,SAAO,IAAIH,OAAJ,CAAY,UAAUI,OAAV,EAAmBC,MAAnB,EAA2B;AAC5CP,WAAOQ,WAAP,CAAmBH,GAAnB,EAAwB,EAACI,MAAM,IAAP,EAAxB,EAAsC,UAAUC,GAAV,EAAeC,OAAf,EAAwB;AAC5D,UAAID,GAAJ,EAASH,OAAOG,GAAP,EAAT,KACKJ,QAAQK,OAAR;AACN,KAHD;AAID,GALM,CAAP;AAMD,CAPD;;AASA,SAASC,aAAT,CAAuBC,MAAvB,EAA+B;AAC7B;AACA,MAAIC,UAAU,EAAd;AACA,MAAI,QAAOD,MAAP,yCAAOA,MAAP,OAAkB,QAAtB,EAAgC;AAC9B,QAAIE,OAAOC,OAAOD,IAAP,CAAYF,MAAZ,CAAX;AACA,SAAK,IAAII,IAAI,CAAb,EAAgBA,IAAIF,KAAKG,MAAzB,EAAiCD,GAAjC,EAAsC;AACpC,UAAIE,OAAON,OAAOE,KAAKE,CAAL,CAAP,CAAX;AACA,UAAIG,MAAML,KAAKE,CAAL,CAAV;;AAEA,UAAG,EAAEE,gBAAgBE,KAAlB,KAA4BF,KAAKD,MAAL,KAAgB,CAA/C,EAAkD;AAChD;AACD;AACD,UAAIC,KAAKD,MAAL,KAAgB,CAApB,EAAuB;AACrB,YAAII,MAAMH,KAAK,CAAL,CAAV;AACA,YAAI,QAAOG,GAAP,yCAAOA,GAAP,OAAe,QAAnB,EAA6B;AAC3BR,kBAAQM,GAAR,IAAeR,cAAcU,GAAd,CAAf;AACD,SAFD,MAGK;AACHR,kBAAQM,GAAR,IAAe,CAACE,OAAO,EAAR,EAAYb,IAAZ,EAAf;AACD;AACF,OARD,MAQM;AACJK,gBAAQM,GAAR,IAAe,EAAf;AACA,aAAK,IAAIG,IAAE,CAAN,EAASC,IAAEL,KAAKD,MAArB,EAA4BK,IAAEC,CAA9B,EAAgCD,GAAhC,EAAoC;AAClCT,kBAAQM,GAAR,EAAaK,IAAb,CAAkBb,cAAcO,KAAKI,CAAL,CAAd,CAAlB;AACD;AACF;AACF;AACF;AACD,SAAOT,OAAP;AACD;;AAEDX,QAAQS,aAAR,GAAwBA,aAAxB","file":"util.js","sourcesContent":["var xml2js = require('xml2js')\nvar Promise = require('bluebird')\n\nexports.parseXMLAsync = function (xml) {\n  return new Promise(function (resolve, reject) {\n    xml2js.parseString(xml, {trim: true}, function (err, content) {\n      if (err) reject(err)\n      else resolve(content)\n    })\n  })\n}\n\nfunction formatMessage(result) {\n  debugger\n  var message = {}\n  if (typeof result === 'object') {\n    var keys = Object.keys(result)\n    for (var i = 0; i < keys.length; i++) {\n      var item = result[keys[i]]\n      var key = keys[i]\n\n      if(!(item instanceof Array) || item.length === 0) {\n        continue\n      }\n      if (item.length === 1) {\n        var val = item[0]\n        if (typeof val === 'object') {\n          message[key] = formatMessage(val)\n        }\n        else {\n          message[key] = (val || '').trim()\n        }\n      }else {\n        message[key] = []\n        for (var j=0, k=item.length;j<k;j++){\n          message[key].push(formatMessage(item[j]))\n        }\n      }\n    }\n  }\n  return message\n}\n\nexports.formatMessage = formatMessage"]}